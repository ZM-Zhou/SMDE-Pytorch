train_dataset:
  params:
    load_KTmatrix: True

losses:
  param_group:
    loss_terms:
      photo_l1:
        type: PhotoLoss
        rate: 1
        args:
          pred_n: synth_img_{}
          target_n: color_{}_aug
          l1_rate: 1
          other_side: True
      perceptual-1:
        type: PhotoLoss
        rate: 0.1
        args:
          pred_n: synth_feats_0_{}
          target_n: raw_feats_0_{}
          l1_rate: 0
          l2_rate: 1
      perceptual-2:
        type: PhotoLoss
        rate: 0.1
        args:
          pred_n: synth_feats_1_{}
          target_n: raw_feats_1_{}
          l1_rate: 0
          l2_rate: 1
      perceptual-3:
        type: PhotoLoss
        rate: 0.1
        args:
          pred_n: synth_feats_2_{}
          target_n: raw_feats_2_{}
          l1_rate: 0
          l2_rate: 1
      smooth:
        type: SmoothLoss
        rate: 0.0008
        args:
          pred_n: disp_{}
          image_n: color_{}
          gamma_rate: 2
          more_kernel: True
          gray_img: True

      proj_ssim:
        type: PhotoLoss
        rate: 1
        mask: mask_{}
        args:
          pred_n: proj_img_{}
          target_n: color_{}
          l1_rate: 0.15
          ssim_rate: 0.85
          other_side: False

      proj-smooth:
        type: SmoothLoss
        rate: 0.001
        mask: smo_mask_{}
        args:
          pred_n: fine_disp_{}
          image_n: color_{}
          gamma_rate: 1
          more_kernel: True
          gray_img: True

visual:
  type:
    color_s: img
    color_o_aug: img
    disp_s: disp
    proj_img_s: img
    synth_img_s: img
    residual_depth_s: error_pn
    fine_disp_s: disp
    mask_s: mask

  shape: [[color_s, color_o_aug],
          [proj_img_s, synth_img_s],
          [disp_s, residual_depth_s],
          [fine_disp_s, mask_s]]

_train: options/_base/datasets/kitti/train_384rc.yaml
_val: options/_base/datasets/kitti/test_384.yaml
_base: options/_base/networks/ocfd_net.yaml

